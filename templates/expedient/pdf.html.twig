{% import _self as formMacros %}

{% macro printMemberRow(member) %}
<tr>
	<td>{{ member.dni }}</td>
	<td>{{ member.name}}</td>
	<td>{{ member.surname1 }}</td>
	<td>{{ member.surname2 }}</td>
	<td>{{ member.numberOfHours }} {{ 'messages.hours' | trans }}</td>
	<td>{{ member.dependency == 1 ? 'messages.si' | trans : 'messages.no' | trans }}</td>
	<td>{{ member.incomeAndAid | number_format(2,'.',',') }} €</td>
	<td>{{ member.professionalIncome | number_format(2,'.',',') }} €</td>
	<td>{{ member.dependencyAmount | number_format(2,'.',',') }} €</td>
	<td>{{ member.capitalIncome | number_format(2,'.',',') }} €</td>
</tr>
{% endmacro %}

{% extends 'pdf.html.twig' %}

{% block title %}{{'title.expedientTitlePDF' | trans }}{% endblock %}

{% block header %}
<header id="header" style="width: 100%">
	<table>
	<tr><td style="width: 60%"></td><td class="text-right" style="width: 40%">{{ 'expedient.createDate' | trans }}:&nbsp;{{ expedient.createDate | date('Y-m-d H:i')}}</td></tr>
	<tr>
		<td colsspan="2" style="width: 100%;"><span  style="vertical-align: middle"><h1 class="h5 text-center text-uppercase">{% block pdftitle %}<h1>{{'title.expedientTitlePDF' | trans }}</h1>{% endblock %}</h1></span></td>
	</tr>
	</table>
</header>
{% endblock %}

{% block body %}
    <table>
	<tr>
		<td style="width: 30%">
			<img class="logo" alt="{{ 'alt.logo' | trans }}" src="{{ absolute_url(asset('build/images/logo.jpg')) }}">
		</td>
	    <td style="width: 70%;">
			<h2>{{ 'title.expedientPrincipal' | trans }}</h2>
			<b>{{ 'expedient.dni' | trans}}: {{ expedient.dni}}</b><br/>
			<b>{{ expedient.name }} {{ expedient.surname1 }} {{ expedient.surname2 }}</b><br/>
			48340 - AMOREBIETA-ETXANO<br/>
			{{ 'expedient.pensioner' | trans }}: {{ expedient.pensioner == 1 ? 'messages.si' | trans : 'messages.no' | trans }}<br/>
			{{ 'expedient.heritage' | trans }}: {{ expedient.heritage}} €<br/>
			{{ 'expedient.rentExpense' | trans }}: {{ expedient.rentExpense}} €<br/>
			{{ 'expedient.mortgageExpense' | trans }}: {{ expedient.mortgageExpense}} €<br/>
	    </td>
	</tr>
    </table>

	<table border="1">
		<tr>
			<th colspan="10" class="text-center">
				<h2 class="h2">{{ 'title.members' | trans }}</h2>
			</th>
		</tr>
		{% if expedient.members is not empty %}
			<tr>
				<th>{{ 'member.dni' | trans }}</th>
				<th>{{ 'member.name' | trans }}</th>
				<th>{{ 'member.surname1' | trans }}</th>
				<th>{{ 'member.surname2' | trans }}</th>
				<th>{{ 'member.numberOfHours' | trans }}</th>
				<th>{{ 'member.dependency' | trans }}</th>
				<th>{{ 'member.incomeAndAid' | trans }}</th>
				<th>{{ 'member.professionalIncome' | trans }}</th>
				<th>{{ 'member.dependencyAmount' | trans }}</th>
				<th>{{ 'member.capitalIncome' | trans }}</th>
			</tr>
		{% endif %}
		{% for member in expedient.members %}
			{{ _self.printMemberRow(member) }}
		{% else %}
			<td colspan="10">{{ 'messages.noMembers' | trans }}</td>
		{% endfor %}
	</table>
	<br/>
	<br/>
	<table style="width: 100%">
		<tr>
			<td width="50%">
				<table border="1">
					<tr>
						<th colspan="3" class="text-center"><h2>{{ 'title.bonifications' | trans }}</h2></th>
					</tr>
					<tr>
						<th>{{ 'expedient.dependencyBonus' | trans }}</th>
						<th>{{ 'expedient.rentBonus' | trans }}</th>
						<th>{{ 'expedient.mortgageBonus' | trans }}</th>
					</tr>
					<tr>
						<td>{{ expedient.dependencyBonus }}</td>
						<td>{{ expedient.dependencyBonus }}</td>
						<td>{{ expedient.dependencyBonus }}</td>
					</tr>
				</table>
			</td>
			<td width="50%">
				<table border="1">
					<tr>
						<th colspan="5" class="text-center"><h2>{{ 'title.incomes' | trans }}</h2></th>
					</tr>
					<tr>
						<th>{{ 'expedient.incomeAndAid' | trans }}</th>
						<th>{{ 'expedient.professionalIncome' | trans }}</th>
						<th>{{ 'expedient.capitalIncome' | trans }}</th>
						<th>{{ 'expedient.rawIncome' | trans }}</th>
						<th>{{ 'expedient.netIncome' | trans }}</th>
					</tr>
					<tr>
						<td>{{ expedient.incomeAndAid }}</td>
						<td>{{ expedient.professionalIncome }}</td>
						<td>{{ expedient.capitalIncome }}</td>
						<td>{{ expedient.rawIncome }}</td>
						<td>{{ expedient.netIncome }}</td>
					</tr>
				</table>
			</td>
		</tr>
	</table>
	<br/>
	<br/>
	<table border="1">
		<tr>
			<th colspan="4" class="text-center"><h2>{{ 'title.calculations' | trans }}</h2></th>
		</tr>
		<tr>
			<th>{{ 'expedient.equityIncrease' | trans }}</th>
			<th>{{ 'expedient.monthlyContribution' | trans }}</th>
			<th>{{ 'expedient.numberOfHours' | trans }}</th>
			<th>{{ 'expedient.pricePerHour' | trans }}</th>
		</tr>
		<tr>
			<td>{{ expedient.equityIncrease }}</td>
			<td>{{ expedient.monthlyContribution }}</td>
			<td>{{ expedient.numberOfHours }}</td>
			<td>{{ expedient.pricePerHour }}</td>
		</tr>
	</table>
	<br/>
{% endblock %}
